# Define the number of steps per epoch
train_steps_per_epoch = len(train_df) // batch_size
valid_steps_per_epoch = len(valid_df) // batch_size

# Train the model
history = model.fit(
    train_generator,
    steps_per_epoch=train_steps_per_epoch,
    epochs=epochs,
    validation_data=valid_generator,
    validation_steps=valid_steps_per_epoch,
    callbacks=[early]
)
